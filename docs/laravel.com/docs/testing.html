<!doctype html>

<html lang="en">


<!-- Mirrored from laravel.com/docs/testing by HTTrack Website Copier/3.x [XR&CO'2013], Sun, 18 May 2014 06:21:46 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
    <title>Laravel - The PHP Framework For Web Artisans.</title>

    <!-- meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=9,chrome=1">
    <meta name="author" content="iKreativ">
    <meta name="description" content="Laravel - The PHP framework for web artisans.">
    <meta name="keywords" content="laravel, php, framework, web, artisans, taylor otwell">

    <!-- favicon -->
    <link rel="shortcut icon" href="../favicon5e1f.png?v=2">

    <!-- we're minifying and combining all our css -->
    <link href="../assets/css/style.css" rel="stylesheet">

    <!-- grab jquery from google cdn. fall back to local if offline -->
    <script src="../../ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
    <script>window.jQuery || document.write('<script src="../assets/js/jquery.js"><\/script>')</script>

    <!-- prettyprint -->
    <script src="../../google-code-prettify.googlecode.com/svn/loader/run_prettify.js"></script>

    <!-- load up our js -->
    <script src="../assets/js/plugins.js"></script>
    <script src="../assets/js/application.js"></script>

    <!-- fonts -->
    <script src="../../use.edgefonts.net/source-sans-pro_n3%2ci3%2cn4%2ci4%2cn6%2ci6%2cn7%2ci7.js"></script>
    <script src="../../use.edgefonts.net/source-code-pro.js"></script>

    <!-- some conditionals for ie -->
    <!--[if IE]><link href="assets/css/ie.css" rel="stylesheet" type="text/css" /><![endif]-->

    <!-- HTML5 elements in less than IE9, yes please! -->
    <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

    <!-- If less than IE8 add some JS for the webfont icons -->
    <!--[if lt IE 8]><script src="assets/js/ie_font.js"></script><![endif]-->

    <!-- asynchronous google analytics. change UA-XXXXX-X to your site's ID -->
    <script>
        var _gaq=[['_setAccount','UA-23865777-1'],['_trackPageview']];
        (function(d,t){
    		var g=d.createElement(t),s=d.getElementsByTagName(t)[0];
        	g.src=('https:'==location.protocol?'//ssl':'//www')+'.google-analytics.com/ga.js';
        	s.parentNode.insertBefore(g,s)
    	}(document,'script'));
    </script>
</head>

<body id="index" class="page docs">

	<!-- wrapper -->
    <div id="wrapper">

        <!-- header -->
        <header id="header" role="header">
            <div class="boxed">
                <!-- tagline -->
                <div id="tagline">
                    <h1>Documentation.</h1>
                </div>
                <!-- /tagline -->

                <!-- version -->
                <div id="version">
                    <ul class="nolist">
                                                    <li><a href="introduction.html" title="Dev">Dev</a></li>
                            <li><a href="testing.html" title="4.2">4.2 (Beta)</a></li>
                            <li><a href="testing.html" title="4.1">4.1</a></li>
                            <li class="current"><a href="testing.html" title="4.0">4.0</a></li>
                                            </ul>
                </div>
                <!-- /version -->
            </div>
        </header>
        <!-- /header -->

        <!-- nav -->
    	<nav id="primary">
    	    <div class="boxed">
    	        <div id="logo-head">
    	           <a href="http://laravel.com/"><img src="../assets/img/logo-head.png" alt="Laravel" /></a>
    	        </div>
                <ul>
                    <li><a href="http://laravel.com/">Welcome</a></li>
                    <li><a href="https://forge.laravel.com/">Forge</a></li>
                    <li class="current-item"><a href="http://laravel.com/docs" title="Documentation">Documentation</a></li>
                    <li><a href="http://laravel.com/api/4.0" title="Laravel Framework API">API</a></li>
                    <li><a href="https://github.com/laravel/laravel" title="Github">Github</a></li>
                    <li><a href="http://laravel.io/forum" title="Laravel Forums">Forums</a></li>
                    <li><a href="http://twitter.com/laravelphp" title="Laravel on Twitter">Twitter</a></li>
                </ul>
            </div>
        </nav>
        <!-- /nav -->

        <!-- content -->
        <div id="content">

            <!-- docs -->
            <section id="documentation">
                <article class="boxed">

                    <!-- docs nav -->
                    <nav id="docs">
                        <!-- Pull table of contents -->
                        <ul>
<li>Preface

<ul>
<li><a href="introduction.html">Introduction</a></li>
<li><a href="quick.html">Quickstart</a></li>
<li><a href="contributing.html">Contributing</a></li>
</ul></li>
<li>Getting Started

<ul>
<li><a href="installation.html">Installation</a></li>
<li><a href="configuration.html">Configuration</a></li>
<li><a href="lifecycle.html">Request Lifecycle</a></li>
<li><a href="routing.html">Routing</a></li>
<li><a href="requests.html">Requests &amp; Input</a></li>
<li><a href="responses.html">Views &amp; Responses</a></li>
<li><a href="controllers.html">Controllers</a></li>
<li><a href="errors.html">Errors &amp; Logging</a></li>
</ul></li>
<li>Learning More

<ul>
<li><a href="cache.html">Cache</a></li>
<li><a href="extending.html">Core Extension</a></li>
<li><a href="events.html">Events</a></li>
<li><a href="facades.html">Facades</a></li>
<li><a href="html.html">Forms &amp; HTML</a></li>
<li><a href="helpers.html">Helpers</a></li>
<li><a href="ioc.html">IoC Container</a></li>
<li><a href="localization.html">Localization</a></li>
<li><a href="mail.html">Mail</a></li>
<li><a href="packages.html">Package Development</a></li>
<li><a href="pagination.html">Pagination</a></li>
<li><a href="queues.html">Queues</a></li>
<li><a href="security.html">Security</a></li>
<li><a href="session.html">Session</a></li>
<li><a href="templates.html">Templates</a></li>
<li><a href="testing.html">Unit Testing</a></li>
<li><a href="validation.html">Validation</a></li>
</ul></li>
<li>Database

<ul>
<li><a href="database.html">Basic Usage</a></li>
<li><a href="queries.html">Query Builder</a></li>
<li><a href="eloquent.html">Eloquent ORM</a></li>
<li><a href="schema.html">Schema Builder</a></li>
<li><a href="migrations.html">Migrations &amp; Seeding</a></li>
<li><a href="redis.html">Redis</a></li>
</ul></li>
<li>Artisan CLI

<ul>
<li><a href="artisan.html">Overview</a></li>
<li><a href="commands.html">Development</a></li>
</ul></li>
</ul>
                    </nav>
                    <!-- /docs nav -->

                    <!-- docs content -->
                    <div id="docs-content">
                        <h1>Unit Testing</h1>

<ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#defining-and-running-tests">Defining &amp; Running Tests</a></li>
<li><a href="#test-environment">Test Environment</a></li>
<li><a href="#calling-routes-from-tests">Calling Routes From Tests</a></li>
<li><a href="#mocking-facades">Mocking Facades</a></li>
<li><a href="#framework-assertions">Framework Assertions</a></li>
<li><a href="#helper-methods">Helper Methods</a></li>
</ul>

<p><a name="introduction"></a></p>

<h2>Introduction</h2>

<p>Laravel is built with unit testing in mind. In fact, support for testing with PHPUnit is included out of the box, and a <code>phpunit.xml</code> file is already setup for your application. In addition to PHPUnit, Laravel also utilizes the Symfony HttpKernel, DomCrawler, and BrowserKit components to allow you to inspect and manipulate your views while testing, allowing to simulate a web browser.</p>

<p>An example test file is provided in the <code>app/tests</code> directory. After installing a new Laravel application, simply run <code>phpunit</code> on the command line to run your tests.</p>

<p><a name="defining-and-running-tests"></a></p>

<h2>Defining &amp; Running Tests</h2>

<p>To create a test case, simply create a new test file in the <code>app/tests</code> directory. The test class should extend <code>TestCase</code>. You may then define test methods as you normally would when using PHPUnit.</p>

<p><strong>An Example Test Class</strong></p>

<pre><code>class FooTest extends TestCase {

    public function testSomethingIsTrue()
    {
        $this-&gt;assertTrue(true);
    }

}
</code></pre>

<p>You may run all of the tests for your application by executing the <code>phpunit</code> command from your terminal.</p>

<blockquote>
  <p><strong>Note:</strong> If you define your own <code>setUp</code> method, be sure to call <code>parent::setUp</code>.</p>
</blockquote>

<p><a name="test-environment"></a></p>

<h2>Test Environment</h2>

<p>When running unit tests, Laravel will automatically set the configuration environment to <code>testing</code>. Also, Laravel includes configuration files for <code>session</code> and <code>cache</code> in the test environment. Both of these drivers are set to <code>array</code> while in the test environment, meaning no session or cache data will be persisted while testing. You are free to create other testing environment configurations as necessary.</p>

<p><a name="calling-routes-from-tests"></a></p>

<h2>Calling Routes From Tests</h2>

<p>You may easily call one of your routes for a test using the <code>call</code> method:</p>

<p><strong>Calling A Route From A Test</strong></p>

<pre><code>$response = $this-&gt;call('GET', 'user/profile');

$response = $this-&gt;call($method, $uri, $parameters, $files, $server, $content);
</code></pre>

<p>You may then inspect the <code>Illuminate\Http\Response</code> object:</p>

<pre><code>$this-&gt;assertEquals('Hello World', $response-&gt;getContent());
</code></pre>

<p>You may also call a controller from a test:</p>

<p><strong>Calling A Controller From A Test</strong></p>

<pre><code>$response = $this-&gt;action('GET', 'HomeController@index');

$response = $this-&gt;action('GET', 'UserController@profile', array('user' =&gt; 1));
</code></pre>

<p>The <code>getContent</code> method will return the evaluated string contents of the response. If your route returns a <code>View</code>, you may access it using the <code>original</code> property:</p>

<pre><code>$view = $response-&gt;original;

$this-&gt;assertEquals('John', $view['name']);
</code></pre>

<p>To call a HTTPS route, you may use the <code>callSecure</code> method:</p>

<pre><code>$response = $this-&gt;callSecure('GET', 'foo/bar');
</code></pre>

<blockquote>
  <p><strong>Note:</strong> Route filters are disabled when in the testing environment. To enable them, add <code>Route::enableFilters()</code> to your test.</p>
</blockquote>

<h3>DOM Crawler</h3>

<p>You may also call a route and receive a DOM Crawler instance that you may use to inspect the content:</p>

<pre><code>$crawler = $this-&gt;client-&gt;request('GET', '/');

$this-&gt;assertTrue($this-&gt;client-&gt;getResponse()-&gt;isOk());

$this-&gt;assertCount(1, $crawler-&gt;filter('h1:contains("Hello World!")'));
</code></pre>

<p>For more information on how to use the crawler, refer to its <a href="http://symfony.com/doc/master/components/dom_crawler.html">official documentation</a>.</p>

<p><a name="mocking-facades"></a></p>

<h2>Mocking Facades</h2>

<p>When testing, you may often want to mock a call to a Laravel static facade. For example, consider the following controller action:</p>

<pre><code>public function getIndex()
{
    Event::fire('foo', array('name' =&gt; 'Dayle'));

    return 'All done!';
}
</code></pre>

<p>We can mock the call to the <code>Event</code> class by using the <code>shouldReceive</code> method on the facade, which will return an instance of a <a href="https://github.com/padraic/mockery">Mockery</a> mock.</p>

<p><strong>Mocking A Facade</strong></p>

<pre><code>public function testGetIndex()
{
    Event::shouldReceive('fire')-&gt;once()-&gt;with('foo', array('name' =&gt; 'Dayle'));

    $this-&gt;call('GET', '/');
}
</code></pre>

<blockquote>
  <p><strong>Note:</strong> You should not mock the <code>Request</code> facade. Instead, pass the input you desire into the <code>call</code> method when running your test.</p>
</blockquote>

<p><a name="framework-assertions"></a></p>

<h2>Framework Assertions</h2>

<p>Laravel ships with several <code>assert</code> methods to make testing a little easier:</p>

<p><strong>Asserting Responses Are OK</strong></p>

<pre><code>public function testMethod()
{
    $this-&gt;call('GET', '/');

    $this-&gt;assertResponseOk();
}
</code></pre>

<p><strong>Asserting Response Statuses</strong></p>

<pre><code>$this-&gt;assertResponseStatus(403);
</code></pre>

<p><strong>Asserting Responses Are Redirects</strong></p>

<pre><code>$this-&gt;assertRedirectedTo('foo');

$this-&gt;assertRedirectedToRoute('route.name');

$this-&gt;assertRedirectedToAction('Controller@method');
</code></pre>

<p><strong>Asserting A View Has Some Data</strong></p>

<pre><code>public function testMethod()
{
    $this-&gt;call('GET', '/');

    $this-&gt;assertViewHas('name');
    $this-&gt;assertViewHas('age', $value);
}
</code></pre>

<p><strong>Asserting The Session Has Some Data</strong></p>

<pre><code>public function testMethod()
{
    $this-&gt;call('GET', '/');

    $this-&gt;assertSessionHas('name');
    $this-&gt;assertSessionHas('age', $value);
}
</code></pre>

<p><a name="helper-methods"></a></p>

<h2>Helper Methods</h2>

<p>The <code>TestCase</code> class contains several helper methods to make testing your application easier.</p>

<p>You may set the currently authenticated user using the <code>be</code> method:</p>

<p><strong>Setting The Currently Authenticated User</strong></p>

<pre><code>$user = new User(array('name' =&gt; 'John'));

$this-&gt;be($user);
</code></pre>

<p>You may re-seed your database from a test using the <code>seed</code> method:</p>

<p><strong>Re-Seeding Database From Tests</strong></p>

<pre><code>$this-&gt;seed();

$this-&gt;seed($connection);
</code></pre>

<p>More information on creating seeds may be found in the <a href="migrations.html#database-seeding">migrations and seeding</a> section of the documentation.</p>
                    </div>
                    <!-- /docs content -->

                </article>
    	    </section>
    	    <!-- /docs -->

        </div>
    	<!-- /content -->

        <!-- footer -->
        <footer id="foot" class="textcenter">
            <div class="boxed">

                <!-- nav -->
                <nav id="secondary">
                    <div id="logo-foot">
        	           <a href="http://laravel.com/"><img src="../assets/img/logo-foot.png" alt="Laravel" /></a>
        	        </div>
                    <ul>
                        <li><a href="http://laravel.com/">Welcome</a></li>
                        <li><a href="https://forge.laravel.com/">Forge</a></li>
                        <li class="current-item"><a href="http://laravel.com/docs" title="Documentation">Documentation</a></li>
                        <li><a href="http://laravel.com/docs" title="Laravel Framework API">API</a></li>
                        <li><a href="https://github.com/laravel/laravel" title="Github">Github</a></li>
                        <li><a href="http://laravel.io/forum" title="Laravel Forums">Forums</a></li>
                        <li><a href="http://twitter.com/laravelphp" title="Laravel on Twitter">Twitter</a></li>
                    </ul>
                </nav>
                <!-- /nav -->

            </div>
        </footer>
        <!-- /footer -->

        <!-- to the top -->
        <div id="top">
            <a href="#index" title="Back to the top">
                <i class="icon-chevron-up"></i>
            </a>
        </div>
        <!-- /to the top -->

    </div>
    <!-- /wrapper -->

    <!-- copyright -->
    <section id="copyright" class="textcenter">
        <div class="boxed">
            <div class="animated slideInLeft">Laravel is a trademark of Taylor Otwell. Copyright &copy; <a href="http://twitter.com/taylorotwell" title="Taylor Otwell" target="_blank">Taylor Otwell</a>. Website built with &hearts; <a href="http://ikreativ.com/" title="iKreativ" target="_blank">iKreativ</a>.</div>
        </div>
    </section>
    <!-- /copyright -->

</body>

<!-- Mirrored from laravel.com/docs/testing by HTTrack Website Copier/3.x [XR&CO'2013], Sun, 18 May 2014 06:21:50 GMT -->
</html>
